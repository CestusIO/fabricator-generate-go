// Code generated by fabricator-generate-plugin-go
//
// Modifications in code regions will be lost during regeneration!

package fabricatorgeneratego_test

import (
	"os"

	fabricatorgeneratego "code.cestus.io/tools/fabricator-generate-go/pkg/fabricator-generate-go"
	. "github.com/onsi/ginkgo/v2"
	. "github.com/onsi/gomega"
)

var _ = Describe("Config", func() {
	It("Deserializes a fabricator config", func() {
		file, err := os.Open("./testdata/deserialize.yml")
		Expect(err).ToNot(HaveOccurred())
		config, err := fabricatorgeneratego.LoadPluginConfig(file)
		Expect(err).ToNot(HaveOccurred())
		expected := fabricatorgeneratego.PluginConfig{
			ApiVersion: "fabricator.cestus.io/v1alpha1",
			Kind:       "Config",
			Components: []fabricatorgeneratego.PluginComponent{
				{
					Name:      "fabricator-generate-go",
					Generator: "fabricator-generate-go",
					Spec: fabricatorgeneratego.Spec{
						PinDependency:     nil,
						ReplaceDependency: nil,
						ToolDependency:    nil,
					},
				},
			},
		}
		Expect(config).To(Equal(expected))
	})
})
